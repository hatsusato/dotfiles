#!/bin/bash

set -eu

usage() {
  cat <<EOF >&2
USAGE: ${0##*/} [-v] TARGET
    backup TARGET to TARGET.bak

    -v  verbose mode
EOF
  exit 1
}
parse-opts() {
  local var
  while getopts v var; do
    case $var in
      v) verbose=v;;
      \?) usage;;
    esac
  done
  return $((OPTIND - 1))
}
main() {
  local verbose=
  parse-opts "$@" || shift $?
  (($# == 1)) || usage
  cp -abfT$verbose "$1" "$1".bak
}

main "$@"

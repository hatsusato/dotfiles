#!/bin/bash

_xkb-load() {
  local cur prev words cword
  _init_completion || return
  local xkbdir=$HOME/.config/local/.xkb keymaps
  local -a list
  [[ -d $xkbdir ]] || return
  keymaps=$(cd "$xkbdir"; compgen -f | grep -e '\.xkb$')
  readarray -t list < <(compgen -W "$keymaps" -- "$cur")
  ((${#list[@]})) && COMPREPLY=($(printf '%q\n' "${list[@]}"))
} && complete -F _xkb-load xkb-load
